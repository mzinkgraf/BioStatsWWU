<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Ben Miner and Matthew Zinkgraf" />

<meta name="date" content="2022-09-21" />

<title>Advanced Graphing</title>

<script src="libs/header-attrs-2.13/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="libs/navigation-1.1/tabsets.js"></script>
<link href="libs/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>



<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<br>

<nav class="navbar navbar-default">
  <div class="container-fluid">
  
    <div class="navbar-header">
      <a class="navbar-brand" href="index.html">
        Biometrics (Biol 340)
      </a>
    </div>

    <div>
      <ul class="nav navbar-nav">
        <li><a href="weekly_labs.html">Weekly Labs</a></li>
        
        <li class="dropdown">
          <a class="dropdown-toggle" data-toggle="dropdown" href="#">Intro to R
          <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="intro_R.html">Intro to R</a></li>
            <li><a href="data_types.html">Data Types</a></li>
            <li><a href="input_R.html">Inputting Data</a></li>
            <li><a href="packages.html">Packages</a></li>
            <li><a href="R_websites.html">Helpful Websites</a></li>
          </ul>
        </li>

        <li class="dropdown">
          <a class="dropdown-toggle" data-toggle="dropdown" href="#">Basic Skills
          <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="des_stats.html">Descriptive Stats</a></li>
            <li><a href="plyr.html">Plyr Package</a></li>
            <li><a href="basic_prob.html">Basic Proability</a></li>
            <li><a href="prob_dist.html">Probability Distributions</a></li>
          </ul>
        </li>
        
        <li class="dropdown">
          <a class="dropdown-toggle" data-toggle="dropdown" href="#">Statistical Tests
          <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="chi_good_test.html">Chi-squared Goodness-of-fit Test</a></li>
            <li><a href="chi_conti_test.html">Chi-squared Contingency Test</a></li>
            <li><a href="t_test.html">t-Test</a></li>
            <li><a href="anova.html">ANOVA</a></li>
            <li><a href="reg_corr_test.html">Regression and Correlation</a></li>
            <li><a href="logistic_test.html">Logistic Regression</a></li>
          </ul>
        </li>
          
        <li class="dropdown">
          <a class="dropdown-toggle" data-toggle="dropdown" href="#">Graphing
          <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="basic_graphing.html">Basic Graphing</a></li>
            <li><a href="adv_graphing.html">Advanced Graphing</a></li>
            <li><a href="ggplots.html">GGplot2</a></li>
          </ul>
        </li>
      </ul>
    </div>
 
  </div>
</nav>

<div class="fluid-row" id="header">




</div>

<div id="header">



<h1 class="title toc-ignore">Advanced Graphing</h1>
<h4 class="author">Ben Miner and Matthew Zinkgraf</h4>
<h4 class="date">2022-09-21</h4>

</div>


<h1>
Advanced Graphing
</h1>
<p>In this lab, you will learn a ton about plotting in R.</p>
<div id="high-level-plotting-functions" class="section level1"
number="1">
<h1><span class="header-section-number">1</span> High-level plotting
functions</h1>
<p>High-level plotting functions will create entire graphs for you. You
have already practiced with some of the high-level plotting functions
like <samp>plot()</samp>, <samp>curve()</samp>, and <samp>hist()</samp>
in previous labs. In this lab, we will explore how to modify or add to
high-level plots, and how to build plots from the low-level plotting
functions. Below is a table of some of the common high-level plotting
functions that people use in the base package.</p>
<dl class="dl-horizontal">
<dt>
plot()
</dt>
<dd>
Creates a plot that is appropiate for the data.
</dd>
<dt>
hist()
</dt>
<dd>
Creates a histogram.
</dd>
<dt>
barplot()
</dt>
<dd>
Creates a barplot.
</dd>
<dt>
boxplot()
</dt>
<dd>
Creates a boxplot.
</dd>
<dt>
curve()
</dt>
<dd>
Creates a line graph based on the supplied function.
</dd>
</dl>
Below is a table with high-level plotting funcions that are cool, but
less often used.
<dl class="dl-horizontal">
<dt>
assocplot()
</dt>
<dd>
Creates a plot of a contigency table that displays the deviations from
independence.
</dd>
<dt>
assocplot()
</dt>
<dd>
Creates a plot of a contigency table that displays the deviations from
independence.
</dd>
<dt>
cdplot()
</dt>
<dd>
Creates a plot of the conditional densities. Think of a plot that shows
how the risk of mortality changes with the amount of a harzardous
chemical.
</dd>
<dt>
coplot()
</dt>
<dd>
Creates a conditional plot.
</dd>
<dt>
fourfoldplot()
</dt>
<dd>
Creates a plot to visualize the differences among 2 or more factors when
to of the factors only have two levels.
</dd>
<dt>
contour()
</dt>
<dd>
Creates a contour plot or addes contour lines to a plot.
</dd>
<dt>
matplot()
</dt>
<dd>
Creates a plot from data in the columns of a matrix.
</dd>
<dt>
mosaicplot()
</dt>
<dd>
Creates a mosaic plot.
</dd>
</dl>
<p>#Low-level plotting functions Below is a table of many of the common
low-level plotting functions that people use.</p>
<dl class="dl-horizontal">
<dt>
plot.new()
</dt>
<dd>
Creates a blank plot.
</dd>
<dt>
plot.window()
</dt>
<dd>
Adds a plotting area and coordinates to a plot.
</dd>
<dt>
axis()
</dt>
<dd>
Adds an axis to a plot.
</dd>
<dt>
title()
</dt>
<dd>
Adds labels and titles to a plot.
</dd>
<dt>
box()
</dt>
<dd>
Creates a box around a plot area.
</dd>
<dt>
text()
</dt>
<dd>
Adds text to a plot.
</dd>
<dt>
mtext()
</dt>
<dd>
Adds text to the margins of a plot.
</dd>
<dt>
legend()
</dt>
<dd>
Adds a legend to a plot.
</dd>
<dt>
points()
</dt>
<dd>
Adds points to a plot.
</dd>
<dt>
lines()
</dt>
<dd>
Adds a line to a plot.
</dd>
<dt>
segment()
</dt>
<dd>
Adds connected segments to a plot.
</dd>
<dt>
abline()
</dt>
<dd>
Adds a line across the entire plotting area.
</dd>
<dt>
rect()
</dt>
<dd>
Adds a rectangle to a plot.
</dd>
<dt>
symbols()
</dt>
<dd>
Adds symbols, like circle, stars, and thermometers, to a plot.
</dd>
<dt>
polygon
</dt>
<dd>
Adds a polygon to a plot.
</dd>
<dt>
rug()
</dt>
<dd>
Adds a data rug to the plot.
</dd>
<dt>
jitter()
</dt>
<dd>
Adds a small amount of variation to the data. It is used to see data
when there are many observations with the small value.
</dd>
<dt>
par()
</dt>
<dd>
Sets the graphing parameters (see the section below on this function).
</dd>
</dl>
<p>Let’s first start with creating a high-level plot and then adding
stuff to it. Remember we already went over how to change some of the
basic aspects of a plot.</p>
<pre class="r"><code>#Create some data
#If you want the data to look just like mine then you can use the function set.seed()
set.seed(1)
x &lt;- sort(runif(100, 0, 25)); y &lt;- x*2 + rnorm(100, sd = 4)

plot(y ~ x, 
    pch = 16, 
    col = &quot;steelblue&quot;, 
    cex = 1.4
)</code></pre>
<p><img src="adv_graphing_files/figure-html/unnamed-chunk-1-1.png" width="672" /></p>
<p>Now that we have a basic graph, let’s use some of the low-level
functions to add stuff to this graph. Add one line at a time and study
carefully what happened. It should be clear why you included each
argument in each function.</p>
<div id="add-text-to-a-plot" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Add text to a
plot</h2>
<p>You can use the functions <samp>text()</samp> and
<samp>mtext()</samp> to add text to a graph.</p>
<pre class="r"><code>#Add text
text(5, 45, &quot;A&quot;, cex = 2)
text(5, 45, letters[2:5], pos = 1:4, col = hcl(seq(60, 360, length.out = 4)))
mtext(&quot;Bottom&quot;, side = 1) #Side 1 is the bottom
mtext(&quot;Left&quot;, side = 2, line = 2) #Side 2 is the left
mtext(&quot;Top&quot;, side = 3, line = 1) #Side 3 is the top
mtext(&quot;Right&quot;, side = 4, adj = 1) #Side 4 is the right</code></pre>
<p><img src="adv_graphing_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
</div>
<div id="add-points-to-a-plot" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Add points to a
plot</h2>
<p>You can use the function <samp>points()</samp> to add points to a
plot.</p>
<pre class="r"><code>points(x, y+10, pch = 15, col = &quot;yellowgreen&quot;)
#Create a shadow effect
#First plot the shadow by shifting the points slightly
points(x+0.2, y+0.3, pch = 16, col = &quot;grey&quot;, cex= 1.4)
#Replot the original points
points(x, y, pch = 16, col = &quot;steelblue&quot;, cex = 1.4)</code></pre>
<p><img src="adv_graphing_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
</div>
<div id="add-lines-to-a-plot" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Add lines to a
plot</h2>
<p>Use the function <samp>abline()</samp> to add lines to a plot.
Remember you need two parameters to describe a straight line, the
y-intercept and the slope. The argument <samp>a</samp> is the intercept
and the argument <samp>b</samp> is the slope.</p>
<pre class="r"><code>abline(a = 0, b = 2)
abline(v = seq(0, 25, by = 5), col = rgb(0.5, 0.5, 0.5, alpha = 0.5))
abline(h = seq(0, 50, by = 10), col = rgb(0.5, 0.5, 0.5, alpha = 0.5))</code></pre>
<p><img src="adv_graphing_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<div class="alert alert-success" role="alert">
<p>Notice that if you give these functions a vector then they will add
more than one line, point, text, etc. For example, look at the last
three calls to the function <samp>abline()</samp>. The first time it was
called, it drew one line. However, the next two line drew multiple lines
because they contained vectors for each argument.</p>
</div>
</div>
<div id="adding-a-legend" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Adding a legend</h2>
<p>Use the function <samp>legend()</samp> to add a legend to a plot.</p>
<p>I will recreate our plot so it isn’t so cluttered and there is some
space for the legend.</p>
<pre class="r"><code>plot(y ~ x, 
    ylim = c(0, 70), #I increased the ylim so there was space for the legend
    pch = 16, 
    col = &quot;steelblue&quot;
)
points(x, rev(y), pch = 15, col = &quot;yellowgreen&quot;)
legend(x = 10, y = 70, legend = c(&quot;Green&quot;, &quot;Blue&quot;), pch = 15:16, col = c(&quot;yellowgreen&quot;, &quot;steelblue&quot;))</code></pre>
<p><img src="adv_graphing_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<h4>
Add symbols to a plot
</h4>
<p>Rarely do I need to use this function to add symbols to a plot, and
the arguments are a bit odd. So, I recommend that you only look it over
after you do the rest of the lab.</p>
<p>Use the function <samp>symbols()</samp> to add symbols to a plot.
This function will add circles, squares, rectangles, stars,
thermometers, and boxplots to a plot. However, by default it will create
a new plot, but you can add the argument <samp>add = T</samp> if you
want to add symbols to an existing plot. I will illustrate both.</p>
<p>Let’s first create a new plot with function <samp>symbols()</samp>.
In this first example, let’s create some circles of different sizes on a
plot. We will need to tell R where to put each circle, and the size of
each circle For circles you only need to give the radius of each circle.
So, let’s plot three circles. The first will be at (1,1) with a size of
0.5. The second will be at (1,2) with a size of 1.0. The third will be
at (2,2) with a size of 2. I need to change the default for the argument
<samp>inches</samp> because by default the function will scale the
largest size to 1 inch–I don’t know why this is the default. For fun, I
will color each circle with a color randomly pulled from the known
colors in R with the function <samp>sample()</samp>.</p>
<pre class="r"><code>xs &lt;- c(1, 1, 2)
ys &lt;- c(1, 2, 2)
sizes &lt;- c(0.25, 0.5, 0.75)
myColors &lt;- sample(colors(), 3)
symbols(xs, ys, circles = sizes, bg = myColors, ylim = c(0,4), xlim = c(0, 4), inches = F)</code></pre>
<p><img src="adv_graphing_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<p>We can also plot “stars”. For circles, we just need a vector of the
radii. For stars, we need to give radii of each ray. I use the function
<samp>cbind()</samp>, which stands for column bind, to create a matrix
out of several vectors. This matrix has the radii for each ray of the
“star”. Notice that the matrix I created below only has three columns.
So, the “stars” will only have three points.</p>
<pre class="r"><code>xs &lt;- c(1, 1, 2)
ys &lt;- c(1, 2, 2)
myStars &lt;- cbind(c(0.25, 0.40, 0.75), c(0.25, 0.40, 0.75), c(0.25, 0.40, 0.75))
myStars</code></pre>
<pre><code>##      [,1] [,2] [,3]
## [1,] 0.25 0.25 0.25
## [2,] 0.40 0.40 0.40
## [3,] 0.75 0.75 0.75</code></pre>
<pre class="r"><code>myColors &lt;- sample(colors(), 3)
symbols(xs, ys, stars = myStars, bg = myColors, ylim = c(0,4), xlim = c(0, 4), inches = F)</code></pre>
<p><img src="adv_graphing_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<p>Here are “stars” with 5 rays, which I specify with a matrix with 5
columns. Notice the radius of each ray doesn’t have to be equal.</p>
<pre class="r"><code>xs &lt;- c(1, 1, 2)
ys &lt;- c(1, 2, 2)
myStars &lt;- cbind(
  c(0.25, 0.80, 0.75), 
  c(0.25, 0.40, 0.75), 
  c(0.50, 0.40, 0.75), 
  c(0.25, 0.40, 0.75), 
  c(0.50, 0.40, 0.75)
)
myColors &lt;- sample(colors(), 3)
symbols(xs, ys, stars = myStars, bg = myColors, ylim = c(0,4), xlim = c(0, 4), inches = F)</code></pre>
<p><img src="adv_graphing_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<p>We can also create thermometers. For thermometers, we need to create
a matrix with 3 or 4 columns. If our matrix has three columns then, the
first two specify the width and height. The third column specifies the
proportion of the thermometer that should be filled, and thus you should
use values between 0 and 1.</p>
<pre class="r"><code>xs &lt;- c(1, 2, 3)
ys &lt;- c(1, 2, 2.3)
myThermos &lt;- cbind(
  c(0.25, 1.0, 0.10), 
  c(0.25, 1.0, 0.75), 
  c(0.50, 0.7, 0.50)
)
myColors &lt;- sample(colors(), 3)
symbols(xs, ys, thermometers = myThermos, fg = myColors, ylim = c(0,4), xlim = c(0, 4), inches = F)</code></pre>
<p><img src="adv_graphing_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<p>If I include a fourth column in the matrix then the third and fourth
columns indicate the lower and upper bounds of the filled box.</p>
<pre class="r"><code>xs &lt;- c(1, 2, 3)
ys &lt;- c(1, 2, 2.3)
myThermos &lt;- cbind(
  c(0.25, 1.0, 0.1), 
  c(0.25, 1.0, 0.4), 
  c(0.50, 0.1, 0.3),
  c(0.90, 0.4, 0.8)
)
myColors &lt;- sample(colors(), 3)
symbols(xs, ys, thermometers = myThermos, fg = myColors, ylim = c(0,4), xlim = c(0, 4), inches = F)</code></pre>
<p><img src="adv_graphing_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<p>Now let’s add a symbol to an existing plot. First, let’s create a
plot, then add a square to it.</p>
<pre class="r"><code>plot(rnorm(20, 10, 2), rnorm(20, 20, 6))
symbols(10, 20, squares = 5, inches = F, add = T, fg = &quot;orange&quot;, asp = 1)</code></pre>
<p><img src="adv_graphing_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<div class="alert alert-warning" role="alert">
<p>You might have noticed that the values we used do not equal the
values plotted. For example, look at the plot above and notice that the
sides of the square do not equal 5. The function <samp>symbols()</samp>
tries to make a square even when the two axes are different, but I have
not figured out how it is determining the size of the square (or other
shapes). So, use this function with caution.</p>
</div>
<p>Now that you see how <samp>symbols()</samp> works. You can also use
this function to create retangles and boxplots.</p>
<h4>
Add polygons to a plot
</h4>
<p>You can add polygons to a graph with function <samp>polygon()</samp>.
This function is a bit tricky because you need to give x and y values
for the points that outline your polygon. So, let’s start with a simple
example. I would to fill in a polygon in the shape of a diamond. First I
create a plot, and then add the polygon.</p>
<pre class="r"><code>plot(1, ylab = &quot;&quot;, xlab = &quot;&quot;, axes = F, frame = T) #notice this plot ranges from 0.6 to 1.4 on both axes
#create the x and y values for the polygon
xs &lt;- c(0.8, 1.0, 1.2, 1.0)
ys &lt;- c(1.0, 0.8, 1.0, 1.2)
polygon(xs, ys, col = &quot;khaki&quot;)</code></pre>
<p><img src="adv_graphing_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<p>Now let’s do something more practical. Let’s say you want to
highlight the 2.5% of the area under each tail of a PDF for a standard
normal distribution. Let’s first plot the standarn normal distribution.
Next calculate the values associated with 2.5% of the area and create
your x and y values. We will use the function <samp>qnorm()</samp> to
find these values. To make our job a little easier, we will add two
polygons, one for each tail.</p>
<pre class="r"><code>curve(dnorm(x), -5, 5, ylab = &quot;Density&quot;)

#Left tail
critical.lt &lt;- qnorm(0.025) #Set left critical value
xs.lt &lt;- seq(-5,critical.lt,by=0.01) #Take small x value steps along the tail
ys.lt &lt;- dnorm(xs.lt) #Take small y value steps along the tail
xs.lt &lt;- c(xs.lt,critical.lt) #Add x coord of corner of polygon
ys.lt &lt;- c(ys.lt,0) #Add y coord of corner of polygon
polygon(xs.lt, ys.lt, col = &quot;salmon2&quot;)

#Right tail
critical.rt &lt;- qnorm(0.975) #Set left critical value
xs.rt &lt;- seq(critical.rt,5, by = 0.01) #Take small x value steps along the tail
ys.rt &lt;- dnorm(xs.rt) #Take small y value steps along the tail
xs.rt &lt;- c(xs.rt,critical.rt) #Add x coord of corner of polygon
ys.rt &lt;- c(ys.rt, 0) #Add y coord of corner of polygon
polygon(xs.rt, ys.rt, col= &quot;mintcream&quot;)</code></pre>
<p><img src="adv_graphing_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
</div>
<div id="build-a-plot-with-low-level-functions" class="section level1"
number="2">
<h1><span class="header-section-number">2</span> Build a plot with
low-level functions</h1>
<p>All of the examples you are about to see will also work on high-level
plots. In fact, the high-level plots are build with low-level
functions.</p>
<p>We first need to create a new plot and create the coordinates to plot
the data. Because the functions add to the existing plot, it is best to
think about working from the background to the foreground. In other
words, if you want to put grid lines, then you should add those first so
that the points will be plotted “over” the lines.</p>
<pre class="r"><code>#We will use the data we already created
plot.new()
plot.window(xlim = range(x), ylim = range(y))

#We will now add gridlines, just like in the example above except they will be added first.
abline(v = seq(0, 25, by = 5), col = &quot;lightgrey&quot;)
abline(h = seq(0, 50, by = 10), col = &quot;lightgrey&quot;)</code></pre>
<p><img src="adv_graphing_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
<p>Now let’s add a box around the plot, axes, and points.</p>
<pre class="r"><code>box()
axis(1) #add axis to bottom
axis(2, at = seq(0, 50, by = 25)) #adds axis to left
points(x, y, pch = 16, col = &quot;darkorchid4&quot;)</code></pre>
<p><img src="adv_graphing_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<p>We can now add the axis labels, a title, and subtitle (and while we
are at it, a x and y rug).</p>
<pre class="r"><code>title(xlab = &quot;Length (cm)&quot;, ylab = &quot;Height (cm)&quot;, main = &quot;Custom graph&quot;, sub = &quot;Pretty cool eh!&quot;)
#And let&#39;s add a rug
rug(x, side = 1) #Add rug to  bottom
rug(y, side = 2) #Add rug to left</code></pre>
<p><img src="adv_graphing_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
</div>
<div id="par-function" class="section level1" number="3">
<h1><span class="header-section-number">3</span> <samp>par()
function</samp></h1>
<p>The function <samp>par()</samp>, which is short for graphing
parameters, has a ton of arguments to alter the graphics you create in
R. Use the help file if you forget the name of an argument or what it
does <samp>?par</samp>. You can see all current values for the arguments
in the function <samp>par()</samp> by calling the function without any
arguments. Below are the names of the all the arguments in the function
<samp>par()</samp>. We will go over some of the common arguments that
people use.</p>
<pre class="r"><code>names(par())</code></pre>
<pre><code>##  [1] &quot;xlog&quot;      &quot;ylog&quot;      &quot;adj&quot;       &quot;ann&quot;       &quot;ask&quot;       &quot;bg&quot;       
##  [7] &quot;bty&quot;       &quot;cex&quot;       &quot;cex.axis&quot;  &quot;cex.lab&quot;   &quot;cex.main&quot;  &quot;cex.sub&quot;  
## [13] &quot;cin&quot;       &quot;col&quot;       &quot;col.axis&quot;  &quot;col.lab&quot;   &quot;col.main&quot;  &quot;col.sub&quot;  
## [19] &quot;cra&quot;       &quot;crt&quot;       &quot;csi&quot;       &quot;cxy&quot;       &quot;din&quot;       &quot;err&quot;      
## [25] &quot;family&quot;    &quot;fg&quot;        &quot;fig&quot;       &quot;fin&quot;       &quot;font&quot;      &quot;font.axis&quot;
## [31] &quot;font.lab&quot;  &quot;font.main&quot; &quot;font.sub&quot;  &quot;lab&quot;       &quot;las&quot;       &quot;lend&quot;     
## [37] &quot;lheight&quot;   &quot;ljoin&quot;     &quot;lmitre&quot;    &quot;lty&quot;       &quot;lwd&quot;       &quot;mai&quot;      
## [43] &quot;mar&quot;       &quot;mex&quot;       &quot;mfcol&quot;     &quot;mfg&quot;       &quot;mfrow&quot;     &quot;mgp&quot;      
## [49] &quot;mkh&quot;       &quot;new&quot;       &quot;oma&quot;       &quot;omd&quot;       &quot;omi&quot;       &quot;page&quot;     
## [55] &quot;pch&quot;       &quot;pin&quot;       &quot;plt&quot;       &quot;ps&quot;        &quot;pty&quot;       &quot;smo&quot;      
## [61] &quot;srt&quot;       &quot;tck&quot;       &quot;tcl&quot;       &quot;usr&quot;       &quot;xaxp&quot;      &quot;xaxs&quot;     
## [67] &quot;xaxt&quot;      &quot;xpd&quot;       &quot;yaxp&quot;      &quot;yaxs&quot;      &quot;yaxt&quot;      &quot;ylbias&quot;</code></pre>
<p>You have and will see that these arguments also get used with other
functions. For example, we change the symbol of points on a plot by
using the <samp>pch</samp> argument in the function <samp>plot()</samp>.
This is because the graphical arguments are passed onto the function
<samp>par()</samp> when you create a plot with function
<samp>plot()</samp>.</p>
<div class="alert alert-success" for="alert">
<p>It is good practice to save the current graphing parameters before
you start changing them. That way you can restore the graphing
parameters to what they originally were.</p>
</div>
<pre class="r"><code>old.par &lt;- par() #saves current par values
par(old.par) #restores the values that you saved
#You will get a few warnings because some of the saved arguments cannot be set.</code></pre>
<p><br> ## Arguments you have already seen</p>
<dl class="dl-horizontal">
<dt>
xlab, ylab
</dt>
<dd>
Specifies the axis labels.
</dd>
<dt>
xlim, ylim
</dt>
<dd>
Specifies the axis limits.
</dd>
<dt>
col
</dt>
<dd>
Specifies the color of the graph.
</dd>
<dt>
pch
</dt>
<dd>
Specifies the symbol of the points on the graph.
</dd>
<dt>
cex, cex.axis, cex.main
</dt>
<dd>
Specifies the size of the points or text in the graph.
</dd>
<dt>
asp
</dt>
<dd>
Specifies the y/x aspect ratio of a plot.
</dl>
<p><br> ## Changing the symbol on a plot</p>
<p>Here are the different symbols, which are set with <samp>pch</samp>
argument.</p>
<pre class="r"><code>plot.new()
plot.window(xlim =  c(0, 5), ylim = c(0, 5), ann = F, asp = 1)
int &lt;-  0:4+0.5
abline(v = int, col = &quot;lightgrey&quot;)
abline(h = int, col = &quot;lightgrey&quot;)
points(rep(int, 5), rep(int, each = 5), pch = 1:25)
text(rep(int, 5), rep(int, each = 5), 1:25, pos = 4)</code></pre>
<p><img src="adv_graphing_files/figure-html/unnamed-chunk-19-1.png" width="672" /></p>
<p><br> ## Changing the style of lines in a plot</p>
<p>The dashing style of a line is set with the <samp>lty</samp> argument
and the line thickness is set with the <samp>lwd</samp> argument. You
can set the <samp>lty</samp> argument with numbers, 1 through 6, or
strings “solid”, “dashed”, “dotted”, “dotdash”, “longdash”,
“twodash”.</p>
<pre class="r"><code>plot.new()
plot.window(xlim = c(0, 6), ylim =  c(0, 6), ann = F, asp = 1)
int &lt;-  0:5+0.5
abline(h = int, lty = 1:6, lwd = 1:6)
text(1, int, paste(rep(&quot;lty = &quot;, 6), 1:6, rep(&quot;, lwd = &quot;, 6), 1:6), pos = 3)</code></pre>
<p><img src="adv_graphing_files/figure-html/unnamed-chunk-20-1.png" width="672" /></p>
<p>You can also make custom dashing with a hexadecimal string of the
format “DBDB”, which reprents the length of the dash D and blank B. For
example, “6161” are long dashes with short spaces between.</p>
<p><br> ## Changing the size of text and symbols</p>
<p>All the arguments that start with <samp>cex</samp> control the size
of text or symbols. For example, <samp>cex.axis</samp> controls the size
of the numbers associated with the axes. Values greater than 1 will
increase the size and values less than 1 (but greater than 0) will
decrease the font.</p>
<dl class="dl-horizontal">
<dt>
cex
</dt>
<dd>
Sets the size of symbols on a plot.
</dd>
<dt>
cex.axis
</dt>
<dd>
Sets the size of axes on a plot. If you want to only change one axis
then use the function <samp>axis</samp> and then customize that axis
with this argument.
</dd>
<dt>
cex.lab
</dt>
<dd>
Sets the size of the axis labels, but not for the x lables on a barplot
(see <samp>cex.names</samp>).
</dd>
<dt>
cex.names
</dt>
<dd>
Sets the size of the x axis labels on a barplot.
<dt>
cex.main
</dt>
<dd>
Sets the size of the title.
</dd>
<dt>
cex.sub
</dt>
<dd>
Sets the size of the subtitle.
</dd>
</dl>
<p><br> ## Changing the color on a plot</p>
<p>There are arguments to change the color of anything on a plot, which
work with most of the graphing functions. Below is a list with the most
commonly used arguments. See the secton about specifying colors for
different ways to set the color.</p>
<dl class="dl-horizontal">
<dt>
col
</dt>
<dd>
Sets the color of the points, lines, or rectanges on a graph.
</dd>
<dt>
col.axis
</dt>
<dd>
Sets the color of the axes.
</dd>
<dt>
col.lab
</dt>
<dd>
Sets the color of the axis labels.
</dd>
<dt>
col.main
</dt>
<dd>
Sets the color of the title.
</dd>
<dt>
col.sub
</dt>
<dd>
Sets the color of the subtitle.
</dd>
<dt>
bg
</dt>
<dd>
Sets the background of the plot.
</dd>
<dt>
fg
</dt>
<dd>
Sets the color of foreground of the plot.
</dd>
</dl>
<p><br /></p>
<div id="changing-the-font-or-font-format" class="section level2"
number="3.1">
<h2><span class="header-section-number">3.1</span> Changing the font or
font format</h2>
<p>There are arguments to change the font or the format of font, which
work with most of the graphing functions. Below is a list with the most
commonly used arguments.</p>
<dl class="dl-horizontal">
<dt>
font
</dt>
<dd>
Sets the format of the text, and requires an integer. 1 = plain, 2 =
bold, 3 = italic, 4 = bold and italic, and 5 = symbol.
</dd>
<dt>
font.axis
</dt>
<dd>
Sets the format of the text in the axes.
</dd>
<dt>
font.lab
</dt>
<dd>
Sets the format of the text in the axis labels.
</dd>
<dt>
font.main
</dt>
<dd>
Sets the format of the text in the title.
</dd>
<dt>
font.sub
</dt>
<dd>
Sets the format of the text in the subtitle.
</dd>
<dt>
ps
</dt>
<dd>
Sets the size of the font.
</dd>
<dt>
family
</dt>
<dd>
Sets the font of text. Typically, choices are “serif”, “sans”, “mono”,
and “symbol”.
</dd>
</dl>
<p>Fonts are a tricky business because they dependent on the device in
which you are view a graph. Something that is viewed in RStudio might
not look the same as something viewed as a PDF.<br />
<br /></p>
</div>
<div id="changing-the-margins" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Changing the
margins</h2>
<p>There are several arguments you can use to change the size of the
margins of your plot. Below is the list with the most commonly used
arguments, though there are several others.</p>
<dl class="dl-horizontal">
<dt>
mar
</dt>
<dd>
Sets the size of the margins outside the plot area and are given in the
number of lines. For example, <samp>mar = c(5, 4, 0, 0) + 1</samp> will
set the bottom margin to 5.1 lines, the left margin to 4.1 lines, and
the top and right margins to 0.1 lines.
</dd>
<dt>
</dt>
<dd>
</dd>
<dt>
mai
</dt>
<dd>
The same as <samp>mar</samp> but you set the size of margins in inches.
For example, <samp>mai = c(3, 2, 0, 0) + 0.05</samp> will set the bottom
margin to 3.05 inches, the left margin to 2.05 inches, and the top and
right margins to 0.05 inches.
</dd>
<dt>
oma
</dt>
<dd>
Sets the size of the outer margins, and are given in the number of
lines. Typically this is used then you plot multiple graphs on a plot.
For example, <samp>oma = c(5, 4, 0, 0) + 1</samp> will set the bottom
margin to 5.1 lines, the left margin to 4.1 lines, and the top and right
margins to 0.1 lines.
</dd>
<dt>
omi
</dt>
<dd>
The same as <samp>oma</samp> but you set the size of the outer margins
in inches. For example, <samp>omi = c(3, 2, 0, 0) + 0.05</samp> will set
the bottom margin to 3.05 inches, the left margin to 2.05 inches, and
the top and right margins to 0.05 inches.
</dd>
</dl>
<p><br /> # Layout for multiple plots</p>
<p>There are two easy ways you can plot multiple graphs in one window.
The first, which is commonly used when you just want a basic layout, is
by setting the the <samp>mfrow</samp> or <samp>mfcol</samp> arguments in
the function <samp>par()</samp>.</p>
<pre class="r"><code>par(mfrow = c(2, 2))
plot(1:10)
curve(x^2, 0, 10)
barplot(rnorm(4))
hist(rnorm(20))</code></pre>
<p><img src="adv_graphing_files/figure-html/unnamed-chunk-21-1.png" width="672" /></p>
<p>The function <samp>layout()</samp> is for more advanced layouts. The
first argument for this function is a matrix in which the number
indicates which the order and layout. For example, if I want 2 plots
across the first row and 1 plot on the second row, then I would create a
matrix with 1 and 2 on the first row, and two 3’s on the second row.</p>
<pre class="r"><code>layout(matrix(c(1,2,3,3), 2, byrow = T))
plot(1:10)
barplot(rnorm(4))
hist(runif(50))</code></pre>
<p><img src="adv_graphing_files/figure-html/unnamed-chunk-22-1.png" width="672" />
# Sprucing up a plot</p>
</div>
<div id="formatting-text" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Formatting text</h2>
<p>You can format the text and add special characters to a plot using
the functions <samp>expression()</samp>, <samp>quote</samp>, and
<samp>bquote<samp>.</p>
<div class="alert alert-success" for="alert">
<p>Look up the help file for plotmath, <samp>?plotmath</samp> for much
more informaton about how to format text and add special symbols.</p>
</div>
<p>Below are a few examples to demonstrate how to bold and italicize or
add special characters.</p>
<pre class="r"><code>#Bold or italicize text
title &lt;- expression(italic(&quot;Species name&quot;))
xlabel &lt;- expression(bold(&quot;X values&quot;))
hist(rnorm(100), main = title, xlab = xlabel)</code></pre>
<p><img src="adv_graphing_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<p>You can paste together text and symbols to create more complex
formatting.</p>
<pre class="r"><code>#Bold and italicize text with special characters
title &lt;- expression(paste(&quot;Distribution of &quot;, italic(&quot;Species name&quot;)))
xlabel &lt;- expression(paste(Lambda, bold(&quot; values&quot;)))
hist(rnorm(100), main = title, xlab = xlabel)

add.text &lt;- expression(paste(&quot;Temp = &quot;, 32*degree))
text(-2, 15, add.text)

add.text2 &lt;- expression(union(A[i], i==1, n))
text(2.5, 15, add.text2)</code></pre>
<p><img src="adv_graphing_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
<div id="adding-color" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Adding color</h2>
<p>There are quite a few functions for creating colors in R. We have
already seen the function <samp>colors()</samp>, which provides all the
built-in names of colors. Type in <samp>demo(“colors”)</samp> to see
some list of the colors.</p>
<p>Below are some functions that will create colors in R. You can use
these functions to create just about any color in R. These functions
have an argument called <samp>alpha</samp> and sets the opacity of the
color.</p>
<dl class="dl-horizontal">
<dt>
rgb
</dt>
<dd>
Create colors by setting the red, green, and blue (rgb) space.
</dd>
<dt>
hsv
</dt>
<dd>
Create colors by setting the hue, saturation, and value (hsv) space.
</dd>
<dt>
hcl
</dt>
<dd>
Create colors by setting the hue, chroma, and luminance (hcl).
</dd>
<dt>
grey
</dt>
<dd>
Create colors by setting the level of grey.
</dd>
</dl>
<pre class="r"><code>plot.new()
plot.window(xlim = c(0, 5), ylim = c(0, 1))
symbols(1, 0.5, circle = 0.25, bg = rgb(1, 0.2, .4), add = T)
symbols(2, 0.5, circle = 0.25, bg = hsv(0.5, 1, 1), add = T)
symbols(3, 0.5, circle = 0.25, bg = hcl(30, 35, 85, alpha = 0.25), add = T)
symbols(4, 0.5, circle = 0.25, bg = grey(0.7), add = T)</code></pre>
<p><img src="adv_graphing_files/figure-html/unnamed-chunk-25-1.png" width="672" /></p>
<p>Below are some functions that will quickly return colors across some
range of the color space, also known as a palette. For the first
argument, you provide the number of colors you want.</p>
<dl class="dl-horizontal">
<dt>
rainbow
</dt>
<dd>
Create colors evenly spaced across the raninbow
</dd>
<dt>
heat.colors
</dt>
<dd>
Create colors evenly spaced across a red to yellow range
</dd>
<dt>
terrain.colors
</dt>
<dd>
Create colors evenly spaced across a green to yellow to white range
</dd>
<dt>
topo.colors
</dt>
<dd>
Create colors evenly spaced across a blue to green to yellow range
</dd>
<dt>
cm.colors
</dt>
<dd>
Create colors evenly spaced across agua to white to purple range
</dd>
</dl>
<pre class="r"><code>barplot(rep(1, 100), col = rainbow(100), border=rainbow(100), axes = F)</code></pre>
<p><img src="adv_graphing_files/figure-html/unnamed-chunk-26-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>barplot(rep(1, 100), col = heat.colors(100), border=heat.colors(100), axes = F)</code></pre>
<p><img src="adv_graphing_files/figure-html/unnamed-chunk-26-2.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>barplot(rep(1, 100), col = terrain.colors(100), border=terrain.colors(100), axes = F)</code></pre>
<p><img src="adv_graphing_files/figure-html/unnamed-chunk-26-3.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>barplot(rep(1, 100), col = topo.colors(100), border=topo.colors(100), axes = F)</code></pre>
<p><img src="adv_graphing_files/figure-html/unnamed-chunk-26-4.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>barplot(rep(1, 100), col = cm.colors(100), border=cm.colors(100), axes = F)</code></pre>
<p><img src="adv_graphing_files/figure-html/unnamed-chunk-26-5.png" width="672" style="display: block; margin: auto;" /></p>
<p>You can create a custom palette with the function
<samp>colorRampPalette()</samp>. The first argument is the colors you
want range across, and returns a function that works like
<samp>rainbow()</samp> or <samp>topo.colors()</samp>.</p>
<pre class="r"><code>#University of Florida colors
my.ramp1 &lt;- colorRampPalette(c(&quot;darkblue&quot;, &quot;darkorange&quot;))
barplot(rep(1, 100), col = my.ramp1(100), border=my.ramp1(100), axes = F)</code></pre>
<p><img src="adv_graphing_files/figure-html/unnamed-chunk-27-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>#You can make a gradient across more than 2 colors
my.ramp2 &lt;- colorRampPalette(c(&quot;steelblue&quot;, &quot;white&quot;, &quot;darksalmon&quot;))
barplot(rep(1, 100), col = my.ramp2(100), border=my.ramp2(100), axes = F)</code></pre>
<p><img src="adv_graphing_files/figure-html/unnamed-chunk-27-2.png" width="672" style="display: block; margin: auto;" /></p>
<p>If this isn’t enough for you, then you should look at the
RColorBrewer package. Below are the palettes available in this
package.</p>
<pre class="r"><code>require(RColorBrewer) #Remember I have already install the package</code></pre>
<pre><code>## Loading required package: RColorBrewer</code></pre>
<pre class="r"><code>display.brewer.all()</code></pre>
<p><img src="adv_graphing_files/figure-html/unnamed-chunk-28-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="grid-package" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Grid package</h1>
<p>If you really want to draw or create custom figures, then you should
look at the grid package. This is beyond what I expect students to learn
during this class, but if you are interested then you can find
information online. Below is an example that I used to create a Venn
diagram for your in-class exam.</p>
<pre class="r"><code>require(grid)</code></pre>
<pre><code>## Loading required package: grid</code></pre>
<pre class="r"><code>grid.newpage()
vp &lt;- viewport(x=0.5,y=0.5,width=1.0, height=1.0)
#pushViewport(vp, name = &quot;Venn&quot;)
grid.circle(0.5, 0.5, r = 0.45, gp = gpar(fill = &quot;gray93&quot;))
outcomes &lt;- paste(&quot;(&quot;, rev(letters[1:8]), &quot;)&quot;, sep=&quot;&quot;)
x.vals &lt;- rep(c(0.6, 0.4), each = 4)
y.vals &lt;- rep(seq(0.3, 0.7, length.out = 4), 2)
grid.text(outcomes, x.vals, y.vals, gp = gpar(cex = 2))</code></pre>
<p><img src="adv_graphing_files/figure-html/unnamed-chunk-29-1.png" width="384" style="display: block; margin: auto;" /></p>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4,h5",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
